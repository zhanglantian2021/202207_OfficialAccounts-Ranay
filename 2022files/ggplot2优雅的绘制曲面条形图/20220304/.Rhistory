plot.margin = margin(20, 20, 20, 20))
ggplot(food_co2) +
geom_rect(aes(xmin = -42, ymin = n*4 - 1.4,
xmax = -10, ymax = n*4 + 1.4), fill = "grey80", color = NA) +
geom_polygon(aes(x, y, group = n), fill = "grey70", color = NA) +
geom_rect(aes(xmin = 0, ymin = n*2 - 0.7,
xmax = co2/25, ymax = n*2 + 0.7), fill = "grey", color = NA) +
geom_text(aes(-40.5, n*4, label = country),color = "white", hjust = 0, size = 8.5,
check_overlap = TRUE) +
geom_text(aes(co2/25-1, n*2, label = co2),color = "white", hjust = 1,
size = 4, check_overlap = TRUE) +
scale_x_continuous(breaks = seq(0, 80, 20),labels = seq(0, 2000, 500))
ggplot(food_co2) +
geom_rect(aes(xmin = -42, ymin = n*4 - 1.4,
xmax = -10, ymax = n*4 + 1.4), fill = "grey80", color = NA) +
geom_polygon(aes(x, y, group = n), fill = "grey70", color = NA) +
geom_rect(aes(xmin = 0, ymin = n*2 - 0.7,
xmax = co2/25, ymax = n*2 + 0.7), fill = "grey", color = NA) +
geom_text(aes(-40.5, n*4, label = country),color = "white", hjust = 0, size = 8.5,
check_overlap = TRUE) +
geom_text(aes(co2/25-1, n*2, label = co2),color = "white", hjust = 1,
size = 4, check_overlap = TRUE) +
scale_x_continuous(breaks = seq(0, 80, 20),labels = seq(0, 2000, 500)) +
theme_minimal() +
theme(
axis.title.x = element_blank(),
axis.text.x = element_text(size = 12),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_line(color = "grey80", size = 0.2),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
plot.margin = margin(20, 20, 20, 20))
ggplot(food_co2) +
geom_rect(aes(xmin = -42, ymin = n*4 - 1.4,
xmax = -10, ymax = n*4 + 1.4), fill = "grey80", color = NA) +
geom_polygon(aes(x, y, group = n), fill = "grey70", color = NA) +
geom_rect(aes(xmin = 0, ymin = n*2 - 0.7,
xmax = co2/25, ymax = n*2 + 0.7), fill = "grey", color = NA) +
geom_text(aes(-40.5, n*4, label = country),color = "white", hjust = 0, size = 8.5,
check_overlap = TRUE) +
geom_text(aes(co2/25-1, n*2, label = co2),color = "white", hjust = 1,
size = 4, check_overlap = TRUE) +
scale_x_continuous(breaks = seq(0, 80, 20),labels = seq(0, 2000, 500)) +
theme_minimal()
ggplot(food_co2) +
geom_rect(aes(xmin = -42, ymin = n*4 - 1.4,
xmax = -10, ymax = n*4 + 1.4), fill = "grey80", color = NA) +
geom_polygon(aes(x, y, group = n), fill = "grey70", color = NA) +
geom_rect(aes(xmin = 0, ymin = n*2 - 0.7,
xmax = co2/25, ymax = n*2 + 0.7), fill = "grey", color = NA) +
geom_text(aes(-40.5, n*4, label = country),color = "white", hjust = 0, size = 8.5,
check_overlap = TRUE) +
geom_text(aes(co2/25-1, n*2, label = co2),color = "white", hjust = 1,
size = 4, check_overlap = TRUE) +
scale_x_continuous(breaks = seq(0, 80, 20),labels = seq(0, 2000, 500)) +
theme_minimal() +
theme(
axis.title.x = element_blank(),
axis.text.x = element_text(size = 12),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_line(color = "grey80", size = 0.2),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
plot.margin = margin(20, 20, 20, 20))
ggplot(food_co2) +
geom_rect(aes(xmin = -42, ymin = n*4 - 1.4,
xmax = -10, ymax = n*4 + 1.4), fill = "grey80", color = NA) +
geom_polygon(aes(x, y, group = n), fill = "grey70", color = NA) +
geom_rect(aes(xmin = 0, ymin = n*2 - 0.7,
xmax = co2/25, ymax = n*2 + 0.7), fill = "grey", color = NA) +
geom_text(aes(-40.5, n*4, label = country),color = "white", hjust = 0, size = 8.5,
check_overlap = TRUE) +
geom_text(aes(co2/25-1, n*2, label = co2),color = "white", hjust = 1,
size = 4, check_overlap = TRUE) +
scale_x_continuous(breaks = seq(0, 80, 20),labels = seq(0, 2000, 500)) +
theme_minimal() +
theme(
axis.title.x = element_blank(),
axis.text.x = element_text(size = 12),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_line(color = "grey80", size = 0.2),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
plot.margin = margin(10,10,10,10))
ggplot(food_co2) +
geom_rect(aes(xmin = -42, ymin = n*4 - 1.4,
xmax = -10, ymax = n*4 + 1.4), fill = "grey80", color = NA) +
geom_polygon(aes(x, y, group = n), fill = "grey70", color = NA) +
geom_rect(aes(xmin = 0, ymin = n*2 - 0.7,
xmax = co2/25, ymax = n*2 + 0.7), fill = "grey", color = NA) +
geom_text(aes(-40.5, n*4, label = country),color = "black", hjust = 0, size = 8.5,
check_overlap = TRUE) +
geom_text(aes(co2/25-1, n*2, label = co2),color = "white", hjust = 1,
size = 4, check_overlap = TRUE) +
scale_x_continuous(breaks = seq(0, 80, 20),labels = seq(0, 2000, 500)) +
theme_minimal() +
theme(
axis.title.x = element_blank(),
axis.text.x = element_text(size = 12),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_line(color = "grey80", size = 0.2),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
plot.margin = margin(10,10,10,10))
ggplot(food_co2) +
geom_rect(aes(xmin = -42, ymin = n*4 - 1.4,
xmax = -10, ymax = n*4 + 1.4), fill = "grey80", color = NA) +
geom_polygon(aes(x, y, group = n), fill = "grey70", color = NA) +
geom_rect(aes(xmin = 0, ymin = n*2 - 0.7,
xmax = co2/25, ymax = n*2 + 0.7), fill = "grey", color = NA) +
geom_text(aes(-40.5, n*4, label = country),color = "white", hjust = 0, size = 8.5,
check_overlap = TRUE) +
geom_text(aes(co2/25-1, n*2, label = co2),color = "black", hjust = 1,
size = 4, check_overlap = TRUE) +
scale_x_continuous(breaks = seq(0, 80, 20),labels = seq(0, 2000, 500)) +
theme_minimal() +
theme(
axis.title.x = element_blank(),
axis.text.x = element_text(size = 12),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_line(color = "grey80", size = 0.2),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
plot.margin = margin(10,10,10,10))
ggplot(food_co2) +
geom_rect(aes(xmin = -42, ymin = n*4 - 1.4,
xmax = -10, ymax = n*4 + 1.4), fill = "grey80", color = NA) +
geom_polygon(aes(x, y, group = n), fill = "grey70", color = NA) +
geom_rect(aes(xmin = 0, ymin = n*2 - 0.7,
xmax = co2/30, ymax = n*2 + 0.7), fill = "grey", color = NA) +
geom_text(aes(-40.5, n*4, label = country),color = "white", hjust = 0, size = 8.5,
check_overlap = TRUE) +
geom_text(aes(co2/30-1, n*2, label = co2),color = "black", hjust = 1,
size = 4, check_overlap = TRUE) +
scale_x_continuous(breaks = seq(0, 80, 20),labels = seq(0, 2000, 500)) +
theme_minimal() +
theme(
axis.title.x = element_blank(),
axis.text.x = element_text(size = 12),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_line(color = "grey80", size = 0.2),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
plot.margin = margin(10,10,10,10))
ggplot(food_co2) +
geom_rect(aes(xmin = -42, ymin = n*4 - 1.4,
xmax = -10, ymax = n*4 + 1.4), fill = "grey80", color = NA) +
geom_polygon(aes(x, y, group = n), fill = "grey70", color = NA) +
geom_rect(aes(xmin = 0, ymin = n*2 - 0.7,
xmax = co2/30, ymax = n*2 + 0.7), fill = "grey", color = NA) +
geom_text(aes(-40.5, n*4, label = country),color = "white", hjust = 0, size = 8,
check_overlap = TRUE) +
geom_text(aes(co2/30-1, n*2, label = co2),color = "black",hjust = 1,
size = 4, check_overlap = TRUE) +
scale_x_continuous(breaks = seq(0,80,20),labels = seq(0,2000,500)) +
theme_minimal() +
theme(
axis.title.x = element_blank(),
axis.text.x = element_text(size = 12),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_line(color = "grey80", size = 0.2),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
plot.margin = margin(10,10,10,10))
ggplot(food_co2) +
geom_rect(aes(xmin = -42, ymin = n*4 - 1.4,
xmax = -10, ymax = n*4 + 1.4), fill = "grey80", color = NA) +
geom_polygon(aes(x, y, group = n), fill = "grey70", color = NA) +
geom_rect(aes(xmin = 0, ymin = n*2 - 0.7,
xmax = co2/30, ymax = n*2 + 0.7), fill = "grey", color = NA) +
geom_text(aes(-40.5, n*4, label = country),color = "white", hjust = 0, size =6,
check_overlap = TRUE) +
geom_text(aes(co2/30-1, n*2, label = co2),color = "black",hjust = 1,
size = 4, check_overlap = TRUE) +
scale_x_continuous(breaks = seq(0,80,20),labels = seq(0,2000,500)) +
theme_minimal() +
theme(
axis.title.x = element_blank(),
axis.text.x = element_text(size = 12),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_line(color = "grey80", size = 0.2),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
plot.margin = margin(10,10,10,10))
food_co2 <- food_consumption %>%
group_by(country) %>%
summarise(co2 = sum(co2_emmission)) %>%
top_n(., 20, co2) %>%
arrange(co2) %>%
mutate(n = -4:5) %>%
rowwise() %>%
mutate(x = list(c(-10, 0, 0, -10)),
y = list(c(n*4 - 1.4, n*2 - 0.7, n*2 + 0.7, n*4 + 1.4))) %>%
unnest(cols = c(x, y)) %>% as.data.frame()
food_co2 <- food_consumption %>%
group_by(country) %>%
summarise(co2 = sum(co2_emmission)) %>%
top_n(., 20, co2) %>%
arrange(co2) %>%
mutate(n = -4:5) %>%
rowwise() %>%
mutate(x = list(c(-20, 0, 0, -20)),
y = list(c(n*4 - 1.4, n*2 - 0.7, n*2 + 0.7, n*4 + 1.4))) %>%
unnest(cols = c(x, y)) %>% as.data.frame()
food_consumption %>%
group_by(country) %>%
summarise(co2 = sum(co2_emmission)) %>%
top_n(., 20, co2) %>%
arrange(co2)
food_co2 <- food_consumption %>%
group_by(country) %>%
summarise(co2 = sum(co2_emmission)) %>%
top_n(., 20, co2) %>%
arrange(co2) %>%
mutate(n = -9:11) %>%
rowwise() %>%
mutate(x = list(c(-20, 0, 0, -20)),
y = list(c(n*4 - 1.4, n*2 - 0.7, n*2 + 0.7, n*4 + 1.4))) %>%
unnest(cols = c(x, y)) %>% as.data.frame()
food_co2 <- food_consumption %>%
group_by(country) %>%
summarise(co2 = sum(co2_emmission)) %>%
top_n(., 20, co2) %>%
arrange(co2) %>%
mutate(n = -9:10) %>%
rowwise() %>%
mutate(x = list(c(-20, 0, 0, -20)),
y = list(c(n*4 - 1.4, n*2 - 0.7, n*2 + 0.7, n*4 + 1.4))) %>%
unnest(cols = c(x, y)) %>% as.data.frame()
ggplot(food_co2) +
geom_rect(aes(xmin = -42, ymin = n*4 - 1.4,
xmax = -20, ymax = n*4 + 1.4), fill = "grey80", color = NA) +
geom_polygon(aes(x, y, group = n), fill = "grey70", color = NA) +
geom_rect(aes(xmin = 0, ymin = n*2 - 0.7,
xmax = co2/30, ymax = n*2 + 0.7), fill = "grey", color = NA) +
geom_text(aes(-40.5, n*4, label = country),color = "white", hjust = 0, size =6,
check_overlap = TRUE) +
geom_text(aes(co2/30-1, n*2, label = co2),color = "black",hjust = 1,
size = 4, check_overlap = TRUE) +
scale_x_continuous(breaks = seq(0,80,20),labels = seq(0,2000,500)) +
theme_minimal() +
theme(
axis.title.x = element_blank(),
axis.text.x = element_text(size = 12),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_line(color = "grey80", size = 0.2),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
plot.margin = margin(10,10,10,10))
ggplot(food_co2) +
geom_rect(aes(xmin = -42, ymin = n*4 - 1.4,
xmax = -20, ymax = n*4 + 1.4), fill = "grey80", color = NA) +
geom_polygon(aes(x, y, group = n), fill = "grey70", color = NA)
food_co2 <- food_consumption %>%
group_by(country) %>%
summarise(co2 = sum(co2_emmission)) %>%
top_n(., 15, co2) %>%
arrange(co2) %>%
mutate(n = -5:9) %>%
rowwise() %>%
mutate(x = list(c(-20, 0, 0, -20)),
y = list(c(n*4 - 1.4, n*2 - 0.7, n*2 + 0.7, n*4 + 1.4))) %>%
unnest(cols = c(x, y)) %>% as.data.frame()
ggplot(food_co2) +
geom_rect(aes(xmin = -42, ymin = n*4 - 1.4,
xmax = -20, ymax = n*4 + 1.4), fill = "grey80", color = NA) +
geom_polygon(aes(x, y, group = n), fill = "grey70", color = NA) +
geom_rect(aes(xmin = 0, ymin = n*2 - 0.7,
xmax = co2/30, ymax = n*2 + 0.7), fill = "grey", color = NA) +
geom_text(aes(-40.5, n*4, label = country),color = "white", hjust = 0, size =6,
check_overlap = TRUE) +
geom_text(aes(co2/30-1, n*2, label = co2),color = "black",hjust = 1,
size = 4, check_overlap = TRUE) +
scale_x_continuous(breaks = seq(0,80,20),labels = seq(0,2000,500)) +
theme_minimal() +
theme(
axis.title.x = element_blank(),
axis.text.x = element_text(size = 12),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_line(color = "grey80", size = 0.2),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
plot.margin = margin(10,10,10,10))
food_consumption
food_co2 <- food_consumption %>%
filter(country !="Hong Kong SAR.China") %>%
group_by(country) %>%
summarise(co2 = sum(co2_emmission)) %>%
top_n(., 15, co2) %>%
arrange(co2) %>%
mutate(n = -5:9) %>%
rowwise() %>%
mutate(x = list(c(-20, 0, 0, -20)),
y = list(c(n*4 - 1.4, n*2 - 0.7, n*2 + 0.7, n*4 + 1.4))) %>%
unnest(cols = c(x, y)) %>% as.data.frame()
ggplot(food_co2) +
geom_rect(aes(xmin = -42, ymin = n*4 - 1.4,
xmax = -20, ymax = n*4 + 1.4), fill = "grey80", color = NA) +
geom_polygon(aes(x, y, group = n), fill = "grey70", color = NA) +
geom_rect(aes(xmin = 0, ymin = n*2 - 0.7,
xmax = co2/30, ymax = n*2 + 0.7), fill = "grey", color = NA) +
geom_text(aes(-40.5, n*4, label = country),color = "white", hjust = 0, size =6,
check_overlap = TRUE) +
geom_text(aes(co2/30-1, n*2, label = co2),color = "black",hjust = 1,
size = 4, check_overlap = TRUE) +
scale_x_continuous(breaks = seq(0,80,20),labels = seq(0,2000,500)) +
theme_minimal() +
theme(
axis.title.x = element_blank(),
axis.text.x = element_text(size = 12),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_line(color = "grey80", size = 0.2),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
plot.margin = margin(10,10,10,10))
food_consumption %>%
filter(country !="Hong Kong SAR.China")
food_consumption <- readr::read_csv('food_consumption.csv')
food_co2 <- food_consumption %>%
filter(country !="Hong Kong SAR.China") %>%
group_by(country) %>%
summarise(co2 = sum(co2_emmission)) %>%
top_n(., 15, co2) %>%
arrange(co2) %>%
mutate(n = -5:9) %>%
rowwise() %>%
mutate(x = list(c(-20, 0, 0, -20)),
y = list(c(n*4 - 1.4, n*2 - 0.7, n*2 + 0.7, n*4 + 1.4))) %>%
unnest(cols = c(x, y)) %>% as.data.frame()
ggplot(food_co2) +
geom_rect(aes(xmin = -42, ymin = n*4 - 1.4,
xmax = -20, ymax = n*4 + 1.4), fill = "grey80", color = NA) +
geom_polygon(aes(x, y, group = n), fill = "grey70", color = NA) +
geom_rect(aes(xmin = 0, ymin = n*2 - 0.7,
xmax = co2/30, ymax = n*2 + 0.7), fill = "grey", color = NA) +
geom_text(aes(-40.5, n*4, label = country),color = "white", hjust = 0, size =6,
check_overlap = TRUE) +
geom_text(aes(co2/30-1, n*2, label = co2),color = "black",hjust = 1,
size = 4, check_overlap = TRUE) +
scale_x_continuous(breaks = seq(0,80,20),labels = seq(0,2000,500)) +
theme_minimal() +
theme(
axis.title.x = element_blank(),
axis.text.x = element_text(size = 12),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_line(color = "grey80", size = 0.2),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
plot.margin = margin(10,10,10,10))
food_consumption %>%
filter(country =="Hong Kong SAR.China")
ggplot(food_co2) +
geom_rect(aes(xmin = -42, ymin = n*4 - 1.4,
xmax = -20, ymax = n*4 + 1.4), fill = "grey80", color = NA) +
geom_polygon(aes(x, y, group = n), fill = "grey70", color = NA) +
geom_rect(aes(xmin = 0, ymin = n*2 - 0.7,
xmax = co2/30, ymax = n*2 + 0.7), fill = "grey", color = NA) +
geom_text(aes(-40.5, n*4, label = country),color = "black", hjust = 0, size =6,
check_overlap = TRUE) +
geom_text(aes(co2/30-1, n*2, label = co2),color = "black",hjust = 1,
size = 4, check_overlap = TRUE) +
scale_x_continuous(breaks = seq(0,80,20),labels = seq(0,2000,500)) +
theme_minimal() +
theme(
axis.title.x = element_blank(),
axis.text.x = element_text(size = 12),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_line(color = "grey80", size = 0.2),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
plot.margin = margin(10,10,10,10))
food_co2 <- food_consumption %>%
filter(country =="Hong Kong SAR. China") %>%
group_by(country) %>%
summarise(co2 = sum(co2_emmission)) %>%
top_n(., 15, co2) %>%
arrange(co2) %>%
mutate(n = -5:9) %>%
rowwise() %>%
mutate(x = list(c(-20, 0, 0, -20)),
y = list(c(n*4 - 1.4, n*2 - 0.7, n*2 + 0.7, n*4 + 1.4))) %>%
unnest(cols = c(x, y)) %>% as.data.frame()
food_co2 <- food_consumption %>%
filter(country !="Hong Kong SAR. China") %>%
group_by(country) %>%
summarise(co2 = sum(co2_emmission)) %>%
top_n(., 15, co2) %>%
arrange(co2) %>%
mutate(n = -5:9) %>%
rowwise() %>%
mutate(x = list(c(-20, 0, 0, -20)),
y = list(c(n*4 - 1.4, n*2 - 0.7, n*2 + 0.7, n*4 + 1.4))) %>%
unnest(cols = c(x, y)) %>% as.data.frame()
ggplot(food_co2) +
geom_rect(aes(xmin = -42, ymin = n*4 - 1.4,
xmax = -20, ymax = n*4 + 1.4), fill = "grey80", color = NA) +
geom_polygon(aes(x, y, group = n), fill = "grey70", color = NA) +
geom_rect(aes(xmin = 0, ymin = n*2 - 0.7,
xmax = co2/30, ymax = n*2 + 0.7), fill = "grey", color = NA) +
geom_text(aes(-40.5, n*4, label = country),color = "black", hjust = 0, size =6,
check_overlap = TRUE) +
geom_text(aes(co2/30-1, n*2, label = co2),color = "black",hjust = 1,
size = 4, check_overlap = TRUE) +
scale_x_continuous(breaks = seq(0,80,20),labels = seq(0,2000,500)) +
theme_minimal() +
theme(
axis.title.x = element_blank(),
axis.text.x = element_text(size = 12),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_line(color = "grey80", size = 0.2),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
plot.margin = margin(10,10,10,10))
ggplot(food_co2) +
geom_rect(aes(xmin = -42, ymin = n*4 - 1.4,
xmax = -20, ymax = n*4 + 1.4), fill = "grey80", color = NA) +
geom_polygon(aes(x, y, group = n), fill = "grey70", color = NA) +
geom_rect(aes(xmin = 0, ymin = n*2 - 0.7,
xmax = co2/30, ymax = n*2 + 0.7), fill = "grey", color = NA) +
geom_text(aes(-40.5, n*4, label = country),color = "white", hjust = 0, size =6,
check_overlap = TRUE) +
geom_text(aes(co2/30-1, n*2, label = co2),color = "black",hjust = 1,
size = 4, check_overlap = TRUE) +
scale_x_continuous(breaks = seq(0,80,20),labels = seq(0,2000,500)) +
theme_minimal() +
theme(
axis.title.x = element_blank(),
axis.text.x = element_text(size = 12),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_line(color = "grey80", size = 0.2),
panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
plot.margin = margin(10,10,10,10))
library(janitor)
library(rvest)
url <- "https://www.nu3.de/blogs/nutrition/food-carbon-footprint-index-2018"
# scrape the website
url_html <- read_html(url)
# extract the HTML table
whole_table <- url_html %>%
html_nodes('table') %>%
html_table(fill = TRUE) %>%
.[[1]]
whole_table
table_content <- whole_table %>%
select(-X1) %>% # remove redundant column
filter(!dplyr::row_number() %in% 1:3) # remove redundant rows
raw_headers <- url_html %>%
html_nodes(".thead-icon") %>%
html_attr('title')
tidy_bottom_header <- raw_headers[28:length(raw_headers)]
tidy_bottom_header[1:10]
raw_middle_header <- raw_headers[17:27]
raw_middle_header
tidy_headers <- c(
rep(raw_middle_header[1:7], each = 2),
"animal_total",
rep(raw_middle_header[8:length(raw_middle_header)], each = 2),
"non_animal_total",
"country_total")
tidy_headers
combined_colnames <- paste(tidy_headers, tidy_bottom_header, sep = ';')
colnames(table_content) <- c("Country", combined_colnames)
glimpse(table_content[, 1:10])
table_content
long_table <- table_content %>%
# make column names observations of Category variable
tidyr::pivot_longer(cols = -Country, names_to = "Category", values_to = "Values") %>%
# separate food-related information from the metric
tidyr::separate(col = Category, into = c("Food Category", "Metric"), sep = ';')
glimpse(long_table)
tidy_table <- long_table %>%
tidyr::pivot_wider(names_from = Metric, values_from = Values) %>%
janitor::clean_names('snake')
glimpse(tidy_table)
final_table <- tidy_table %>%
rename(consumption = 3,
co2_emmission = 4) %>%
filter(!stringr::str_detect(food_category, "total"))
clean_table <- final_table %>%
mutate_at(vars(consumption, co2_emmission), parse_number)
clean_table
