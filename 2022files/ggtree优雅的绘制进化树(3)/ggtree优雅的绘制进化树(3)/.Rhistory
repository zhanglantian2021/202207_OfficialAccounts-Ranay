geom_fruit(data=dat3,geom=geom_bar,
mapping=aes(y=ID, x=value,fill=name,alphe=value),
pwidth=0.38,
orientation="y",
stat="identity",
)+
scale_fill_manual(values=c("#FF0000","#00A08A", "#F2AD00", "#F98400", "#5BBCD6"))+
scale_alpha_continuous(range=c(0, 1),
guide=guide_legend(keywidth = 0.3,keyheight = 0.3))+
geom_treescale(fontsize=2, linesize=0.3, x=4.9, y=0.1) +
theme(legend.position=c(0.93, 0.5),
legend.background=element_rect(fill=NA),
legend.title=element_text(size=6.5),
legend.text=element_text(size=4.5),
legend.spacing.y = unit(0.02, "cm"),
)
p + new_scale_fill() +
geom_fruit(data=dat2, geom=geom_tile,
mapping=aes(y=ID, x=name,alpha=value,fill=name),
color = "grey50",offset = 0.04,size = 0.02)+
scale_fill_manual(values=c("#FFC125","#87CEFA","#7B68EE","#808080",
"#800080", "#9ACD32","#D15FEE","#FFC0CB",
"#EE6A50","#8DEEEE", "#006400","#800000",
"#B0171F","#191970"))+
scale_alpha_continuous(range=c(0, 1),
guide=guide_legend(keywidth = 0.3,
keyheight = 0.3, order=5))+
new_scale_fill()+
geom_fruit(data=dat3,geom=geom_bar,
mapping=aes(y=ID, x=value,fill=name),
pwidth=0.38,
orientation="y",
stat="identity",
)+
scale_fill_manual(values=c("#E64B35FF","#4DBBD5FF","#00A087FF","#3C5488FF","#F39B7FFF","#8491B4FF"),
guide=guide_legend(keywidth = 0.3,
keyheight = 0.3, order=4))+
geom_treescale(fontsize=2, linesize=0.3, x=4.9, y=0.1) +
theme(legend.position=c(0.93, 0.5),
legend.background=element_rect(fill=NA),
legend.title=element_text(size=6.5),
legend.text=element_text(size=4.5),
legend.spacing.y = unit(0.02, "cm"),
)
p + new_scale_fill() +
geom_fruit(data=dat2, geom=geom_tile,
mapping=aes(y=ID, x=name,alpha=value,fill=name),
color = "grey50",offset = 0.04,size = 0.02)+
scale_fill_manual(values=c("#FFC125","#87CEFA","#7B68EE","#808080",
"#800080", "#9ACD32","#D15FEE","#FFC0CB",
"#EE6A50","#8DEEEE", "#006400","#800000",
"#B0171F","#191970"))+
scale_alpha_continuous(range=c(0, 1),
guide=guide_legend(keywidth = 0.3,
keyheight = 0.3, order=5))+
new_scale_fill()+
geom_fruit(data=dat3,geom=geom_bar,
mapping=aes(y=ID, x=value,fill=name),
pwidth=0.38,
orientation="y",
stat="identity",
)+
scale_fill_manual(values=c("#E64B35FF","#4DBBD5FF","#00A087FF","#3C5488FF","#F39B7FFF","#8491B4FF"),
guide=guide_legend(keywidth = 0.3,
keyheight = 0.3, order=4))+
geom_treescale(fontsize=2, linesize=0.1, x=4.9, y=0.1) +
theme(legend.position=c(0.93, 0.5),
legend.background=element_rect(fill=NA),
legend.title=element_text(size=6.5),
legend.text=element_text(size=4.5),
legend.spacing.y = unit(0.02, "cm"),
)
p + new_scale_fill() +
geom_fruit(data=dat2, geom=geom_tile,
mapping=aes(y=ID, x=name,alpha=value,fill=name),
color = "grey50",offset = 0.04,size = 0.02)+
scale_fill_manual(values=c("#FFC125","#87CEFA","#7B68EE","#808080",
"#800080", "#9ACD32","#D15FEE","#FFC0CB",
"#EE6A50","#8DEEEE", "#006400","#800000",
"#B0171F","#191970"))+
scale_alpha_continuous(range=c(0, 1),
guide=guide_legend(keywidth = 0.3,
keyheight = 0.3, order=5))+
new_scale_fill()+
geom_fruit(data=dat3,geom=geom_bar,
mapping=aes(y=ID, x=value,fill=name),
pwidth=0.38,
orientation="y",
stat="identity",
)+
scale_fill_manual(values=c("#E64B35FF","#4DBBD5FF","#00A087FF","#3C5488FF","#F39B7FFF","#8491B4FF"),
guide=guide_legend(keywidth = 0.3,
keyheight = 0.3, order=4))+
#  geom_treescale(fontsize=2, linesize=0.1, x=4.9, y=0.1) +
theme(legend.position=c(0.93, 0.5),
legend.background=element_rect(fill=NA),
legend.title=element_text(size=6.5),
legend.text=element_text(size=4.5),
legend.spacing.y = unit(0.02, "cm"),
)
p + new_scale_fill() +
geom_fruit(data=dat2, geom=geom_tile,
mapping=aes(y=ID, x=name,alpha=value,fill=name),
color = "grey50",offset = 0.04,size = 0.02)+
scale_fill_manual(values=c("#FFC125","#87CEFA","#7B68EE","#808080",
"#800080", "#9ACD32","#D15FEE","#FFC0CB",
"#EE6A50","#8DEEEE", "#006400","#800000",
"#B0171F","#191970"))+
scale_alpha_continuous(range=c(0, 1),
guide=guide_legend(keywidth = 0.3,
keyheight = 0.3, order=5))+
new_scale_fill()+
geom_fruit(data=dat3,geom=geom_bar,
mapping=aes(y=ID, x=value,fill=name),
pwidth=0.38,
orientation="y",
stat="identity",
)+
scale_fill_manual(values=c("#E64B35FF","#4DBBD5FF","#00A087FF","#3C5488FF","#F39B7FFF","#8491B4FF"),
guide=guide_legend(keywidth = 0.3,
keyheight = 0.3, order=4))
p + new_scale_fill() +
geom_fruit(data=dat2, geom=geom_tile,
mapping=aes(y=ID, x=name,alpha=value,fill=name),
color = "grey50",offset = 0.04,size = 0.02)+
scale_fill_manual(values=c("#FFC125","#87CEFA","#7B68EE","#808080",
"#800080", "#9ACD32","#D15FEE","#FFC0CB",
"#EE6A50","#8DEEEE", "#006400","#800000",
"#B0171F","#191970"))+
scale_alpha_continuous(range=c(0, 1),
guide=guide_legend(keywidth = 0.3,
keyheight = 0.3, order=5))+
new_scale_fill()+
geom_fruit(data=dat3,geom=geom_bar,
mapping=aes(y=ID, x=value,fill=name),
pwidth=0.38,
orientation="y",
stat="identity",
)+
scale_fill_manual(values=c("#E64B35FF","#4DBBD5FF","#00A087FF","#3C5488FF","#F39B7FFF","#8491B4FF"),
guide=guide_legend(keywidth = 0.5,
keyheight = 0.5, order=4))+
theme(legend.position=c(0.93, 0.5),
legend.background=element_rect(fill=NA),
legend.title=element_text(size=6.5),
legend.text=element_text(size=4.5),
legend.spacing.y = unit(0.02, "cm"),
)
p + new_scale_fill() +
geom_fruit(data=dat2, geom=geom_tile,
mapping=aes(y=ID, x=name,alpha=value,fill=name),
color = "grey50",offset = 0.04,size = 0.02)+
scale_fill_manual(values=c("#FFC125","#87CEFA","#7B68EE","#808080",
"#800080", "#9ACD32","#D15FEE","#FFC0CB",
"#EE6A50","#8DEEEE", "#006400","#800000",
"#B0171F","#191970"))+
scale_alpha_continuous(range=c(0,1),
guide=guide_legend(keywidth = 0.5,
keyheight = 0.5, order=5))+
new_scale_fill()+
geom_fruit(data=dat3,geom=geom_bar,
mapping=aes(y=ID, x=value,fill=name),
pwidth=0.38,
orientation="y",
stat="identity",
)+
scale_fill_manual(values=c("#E64B35FF","#4DBBD5FF","#00A087FF","#3C5488FF","#F39B7FFF","#8491B4FF"),
guide=guide_legend(keywidth = 0.5,
keyheight = 0.5, order=4))+
theme(legend.position=c(0.93, 0.5),
legend.background=element_rect(fill=NA),
legend.title=element_text(size=6.5),
legend.text=element_text(size=10),
)
p + new_scale_fill() +
geom_fruit(data=dat2, geom=geom_tile,
mapping=aes(y=ID, x=name,alpha=value,fill=name),
color = "grey50",offset = 0.04,size = 0.02)+
scale_fill_manual(values=c("#FFC125","#87CEFA","#7B68EE","#808080",
"#800080", "#9ACD32","#D15FEE","#FFC0CB",
"#EE6A50","#8DEEEE", "#006400","#800000",
"#B0171F","#191970"))+
new_scale_fill()+
geom_fruit(data=dat3,geom=geom_bar,
mapping=aes(y=ID, x=value,fill=name),
pwidth=0.38,
orientation="y",
stat="identity",
)+
scale_fill_manual(values=c("#E64B35FF","#4DBBD5FF","#00A087FF","#3C5488FF","#F39B7FFF","#8491B4FF"),
guide=guide_legend(keywidth = 0.5,
keyheight = 0.5, order=4))+
theme(legend.position=c(0.93, 0.5),
legend.background=element_rect(fill=NA),
legend.title=element_text(size=6.5),
legend.text=element_text(size=10)
)
p + new_scale_fill() +
geom_fruit(data=dat2, geom=geom_tile,
mapping=aes(y=ID, x=name,fill=name),
color = "grey50",offset = 0.04,size = 0.02)+
scale_fill_manual(values=c("#FFC125","#87CEFA","#7B68EE","#808080",
"#800080", "#9ACD32","#D15FEE","#FFC0CB",
"#EE6A50","#8DEEEE", "#006400","#800000",
"#B0171F","#191970"))+
new_scale_fill()+
geom_fruit(data=dat3,geom=geom_bar,
mapping=aes(y=ID, x=value,fill=name),
pwidth=0.38,
orientation="y",
stat="identity",
)+
scale_fill_manual(values=c("#E64B35FF","#4DBBD5FF","#00A087FF","#3C5488FF","#F39B7FFF","#8491B4FF"),
guide=guide_legend(keywidth = 0.5,
keyheight = 0.5, order=4))+
theme(legend.position=c(0.93, 0.5),
legend.background=element_rect(fill=NA),
legend.title=element_text(size=6.5),
legend.text=element_text(size=10)
)
p + new_scale_fill() +
geom_fruit(data=dat2, geom=geom_tile,
mapping=aes(y=ID, x=name,alpha=value,fill=name),
color = "grey50",offset = 0.04,size = 0.02)+
scale_fill_manual(values=c("#FFC125","#87CEFA","#7B68EE","#808080",
"#800080", "#9ACD32","#D15FEE","#FFC0CB",
"#EE6A50","#8DEEEE", "#006400","#800000",
"#B0171F","#191970"))+
scale_alpha_continuous(guide=guide_legend(NULL))+
new_scale_fill()+
geom_fruit(data=dat3,geom=geom_bar,
mapping=aes(y=ID, x=value,fill=name),
pwidth=0.38,
orientation="y",
stat="identity",
)+
scale_fill_manual(values=c("#E64B35FF","#4DBBD5FF","#00A087FF","#3C5488FF","#F39B7FFF","#8491B4FF"),
guide=guide_legend(keywidth = 0.5,
keyheight = 0.5, order=4))+
theme(legend.position=c(0.93, 0.5),
legend.background=element_rect(fill=NA),
legend.title=element_text(size=6.5),
legend.text=element_text(size=10)
)
p + new_scale_fill() +
geom_fruit(data=dat2, geom=geom_tile,
mapping=aes(y=ID, x=name,alpha=value,fill=name),
color = "grey50",offset = 0.04,size = 0.02)+
scale_fill_manual(values=c("#FFC125","#87CEFA","#7B68EE","#808080",
"#800080", "#9ACD32","#D15FEE","#FFC0CB",
"#EE6A50","#8DEEEE", "#006400","#800000",
"#B0171F","#191970"))+
scale_alpha_continuous(guide=NULL)+
new_scale_fill()+
geom_fruit(data=dat3,geom=geom_bar,
mapping=aes(y=ID, x=value,fill=name),
pwidth=0.38,
orientation="y",
stat="identity",
)+
scale_fill_manual(values=c("#E64B35FF","#4DBBD5FF","#00A087FF","#3C5488FF","#F39B7FFF","#8491B4FF"),
guide=guide_legend(keywidth = 0.5,
keyheight = 0.5, order=4))+
theme(legend.position=c(0.93, 0.5),
legend.background=element_rect(fill=NA),
legend.title=element_text(size=6.5),
legend.text=element_text(size=10)
)
p + new_scale_fill() +
geom_fruit(data=dat2, geom=geom_tile,
mapping=aes(y=ID, x=name,alpha=value,fill=name),
color = "grey50",offset = 0.04,size = 0.02)+
scale_fill_manual(values=c("#FFC125","#87CEFA","#7B68EE","#808080",
"#800080", "#9ACD32","#D15FEE","#FFC0CB",
"#EE6A50","#8DEEEE", "#006400","#800000",
"#B0171F","#191970"))+
scale_alpha_continuous(guide=NULL)+
scale_size_continuous(range = c(1, 2.5),
guide = guide_legend(keywidth = 0.5,
keyheight = 0.5, order=3,
override.aes=list(starshape=15)))+
new_scale_fill()+
geom_fruit(data=dat3,geom=geom_bar,
mapping=aes(y=ID, x=value,fill=name),
pwidth=0.38,
orientation="y",
stat="identity",
)+
scale_fill_manual(values=c("#E64B35FF","#4DBBD5FF","#00A087FF","#3C5488FF","#F39B7FFF","#8491B4FF"),
guide=guide_legend(keywidth = 0.5,
keyheight = 0.5, order=4))+
theme(legend.position=c(0.93, 0.5),
legend.background=element_rect(fill=NA),
legend.title=element_text(size=6.5),
legend.text=element_text(size=10)
)
p + new_scale_fill() +
geom_fruit(data=dat2, geom=geom_tile,
mapping=aes(y=ID, x=name,alpha=value,fill=name),
color = "grey50",offset = 0.04,size = 0.02)+
scale_fill_manual(values=c("#FFC125","#87CEFA","#7B68EE","#808080",
"#800080", "#9ACD32","#D15FEE","#FFC0CB",
"#EE6A50","#8DEEEE", "#006400","#800000",
"#B0171F","#191970"))+
scale_alpha_continuous(guide=NULL)+
scale_size_continuous(uide = guide_legend(keywidth = 0.5,keyheight = 0.5))+
new_scale_fill()+
geom_fruit(data=dat3,geom=geom_bar,
mapping=aes(y=ID, x=value,fill=name),
pwidth=0.38,
orientation="y",
stat="identity",
)+
scale_fill_manual(values=c("#E64B35FF","#4DBBD5FF","#00A087FF","#3C5488FF","#F39B7FFF","#8491B4FF"),
guide=guide_legend(keywidth = 0.5,keyheight = 0.5))+
theme(legend.position=c(0.93, 0.5),
legend.background=element_rect(fill=NA),
legend.title=element_text(size=6.5),
legend.text=element_text(size=10)
)
p + new_scale_fill() +
geom_fruit(data=dat2, geom=geom_tile,
mapping=aes(y=ID, x=name,alpha=value,fill=name),
color = "grey50",offset = 0.04,size = 0.02)+
scale_fill_manual(values=c("#FFC125","#87CEFA","#7B68EE","#808080",
"#800080", "#9ACD32","#D15FEE","#FFC0CB",
"#EE6A50","#8DEEEE", "#006400","#800000",
"#B0171F","#191970"))+
scale_alpha_continuous(guide=NULL)+
scale_size_continuous(guide = guide_legend(keywidth = 0.5,keyheight = 0.5))+
new_scale_fill()+
geom_fruit(data=dat3,geom=geom_bar,
mapping=aes(y=ID, x=value,fill=name),
pwidth=0.38,
orientation="y",
stat="identity",
)+
scale_fill_manual(values=c("#E64B35FF","#4DBBD5FF","#00A087FF","#3C5488FF","#F39B7FFF","#8491B4FF"),
guide=guide_legend(keywidth = 0.5,keyheight = 0.5))+
theme(legend.position=c(0.93, 0.5),
legend.background=element_rect(fill=NA),
legend.title=element_text(size=6.5),
legend.text=element_text(size=10)
)
p + new_scale_fill() +
geom_fruit(data=dat2, geom=geom_tile,
mapping=aes(y=ID, x=name,alpha=value,fill=name),
color = "grey50",offset = 0.04,size = 0.02)+
scale_fill_manual(values=c("#FFC125","#87CEFA","#7B68EE","#808080",
"#800080", "#9ACD32","#D15FEE","#FFC0CB",
"#EE6A50","#8DEEEE", "#006400","#800000",
"#B0171F","#191970"))+
scale_alpha_continuous(guide=NULL)+
new_scale_fill()+
geom_fruit(data=dat3,geom=geom_bar,
mapping=aes(y=ID, x=value,fill=name),
pwidth=0.38,
orientation="y",
stat="identity",
)+
scale_fill_manual(values=c("#E64B35FF","#4DBBD5FF","#00A087FF","#3C5488FF","#F39B7FFF","#8491B4FF"))+
theme(legend.position=c(0.93, 0.5),
legend.background=element_rect(fill=NA),
legend.title=element_text(size=6.5),
legend.text=element_text(size=10)
)
p + new_scale_fill() +
geom_fruit(data=dat2, geom=geom_tile,
mapping=aes(y=ID, x=name,alpha=value,fill=name),
color = "grey50",offset = 0.04,size = 0.02)+
scale_fill_manual(values=c("#FFC125","#87CEFA","#7B68EE","#808080",
"#800080", "#9ACD32","#D15FEE","#FFC0CB",
"#EE6A50","#8DEEEE", "#006400","#800000",
"#B0171F","#191970"))+
scale_alpha_continuous(guide=NULL)+
new_scale_fill()+
geom_fruit(data=dat3,geom=geom_bar,
mapping=aes(y=ID, x=value,fill=name),
pwidth=0.38,
orientation="y",
stat="identity",
)+
scale_fill_manual(values=c("#E64B35FF","#4DBBD5FF","#00A087FF","#3C5488FF","#F39B7FFF","#8491B4FF"))+
theme(legend.position=c(0.5, 0.5),
legend.background=element_rect(fill=NA),
legend.title=element_blank(),
legend.text=element_text(size=10)
)
p + new_scale_fill() +
geom_fruit(data=dat2, geom=geom_tile,
mapping=aes(y=ID, x=name,alpha=value,fill=name),
color = "grey50",offset = 0.04,size = 0.02)+
scale_fill_manual(values=c("#FFC125","#87CEFA","#7B68EE","#808080",
"#800080", "#9ACD32","#D15FEE","#FFC0CB",
"#EE6A50","#8DEEEE", "#006400","#800000",
"#B0171F","#191970"))+
scale_alpha_continuous(guide=NULL)+
new_scale_fill()+
geom_fruit(data=dat3,geom=geom_bar,
mapping=aes(y=ID, x=value,fill=name),
pwidth=0.38,
orientation="y",
stat="identity",
)+
scale_fill_manual(values=c("#E64B35FF","#4DBBD5FF","#00A087FF","#3C5488FF","#F39B7FFF","#8491B4FF"))+
theme(legend.position=c(0.4, 0.5),
legend.background=element_rect(fill=NA),
legend.title=element_blank(),
legend.text=element_text(size=10)
)
p + new_scale_fill() +
geom_fruit(data=dat2, geom=geom_tile,
mapping=aes(y=ID, x=name,alpha=value,fill=name),
color = "grey50",offset = 0.04,size = 0.02)+
scale_fill_manual(values=c("#FFC125","#87CEFA","#7B68EE","#808080",
"#800080", "#9ACD32","#D15FEE","#FFC0CB",
"#EE6A50","#8DEEEE", "#006400","#800000",
"#B0171F","#191970"))+
scale_alpha_continuous(guide=NULL)+
new_scale_fill()+
geom_fruit(data=dat3,geom=geom_bar,
mapping=aes(y=ID, x=value,fill=name),
pwidth=0.38,
orientation="y",
stat="identity",
)+
scale_fill_manual(values=c("#E64B35FF","#4DBBD5FF","#00A087FF","#3C5488FF","#F39B7FFF","#8491B4FF"))+
theme(legend.position=c(0.45, 0.5),
legend.background=element_rect(fill=NA),
legend.title=element_blank(),
legend.text=element_text(size=10)
)
dat3 <- dat2 %>% arrange(desc(value)) %>% group_by(ID) %>%
filter(row_number()==1) %>% ungroup() %>%
mutate(name = trimws(str_remove(name,"(\\s+[A-Za-z]+)?[0-9-]+")))
p + new_scale_fill() +
geom_fruit(data=dat2, geom=geom_tile,
mapping=aes(y=ID, x=name,alpha=value,fill=name),
color = "grey50",offset = 0.04,size = 0.02)+
scale_fill_manual(values=c("#FFC125","#87CEFA","#7B68EE","#808080",
"#800080", "#9ACD32","#D15FEE","#FFC0CB",
"#EE6A50","#8DEEEE", "#006400","#800000",
"#B0171F","#191970"))+
scale_alpha_continuous(guide=NULL)+
new_scale_fill()+
geom_fruit(data=dat3,geom=geom_bar,
mapping=aes(y=ID, x=value,fill=name),
pwidth=0.38,
orientation="y",
stat="identity",
)+
scale_fill_manual(values=c("#E64B35FF","#4DBBD5FF","#00A087FF","#3C5488FF","#F39B7FFF","#8491B4FF"))+
theme(legend.position=c(0.45, 0.5),
legend.background=element_rect(fill=NA),
legend.title=element_blank(),
legend.text=element_text(size=10)
)
dat3 <- dat2 %>% arrange(desc(value)) %>% group_by(ID) %>%
filter(row_number()==1) %>% ungroup() %>%
mutate(name = trimws(str_remove(name,"(\\s+[A-Za-z]+)?[0-9-]+"))) %>%
sample_frac(.6)
p <- hclust(dist(df)) %>% ggtree(layout="fan", open.angle=10)
p + new_scale_fill() +
geom_fruit(data=dat2, geom=geom_tile,
mapping=aes(y=ID, x=name,alpha=value,fill=name),
color = "grey50",offset = 0.04,size = 0.02)+
scale_fill_manual(values=c("#FFC125","#87CEFA","#7B68EE","#808080",
"#800080", "#9ACD32","#D15FEE","#FFC0CB",
"#EE6A50","#8DEEEE", "#006400","#800000",
"#B0171F","#191970"))+
scale_alpha_continuous(guide=NULL)+
new_scale_fill()+
geom_fruit(data=dat3,geom=geom_bar,
mapping=aes(y=ID, x=value,fill=name),
pwidth=0.38,
orientation="y",
stat="identity",
)+
scale_fill_manual(values=c("#E64B35FF","#4DBBD5FF","#00A087FF","#3C5488FF","#F39B7FFF","#8491B4FF"))+
theme(legend.position=c(0.45, 0.5),
legend.background=element_rect(fill=NA),
legend.title=element_blank(),
legend.text=element_text(size=10)
)
dat3 <- dat2 %>% arrange(desc(value)) %>% group_by(ID) %>%
filter(row_number()==1) %>% ungroup() %>%
mutate(name = trimws(str_remove(name,"(\\s+[A-Za-z]+)?[0-9-]+"))) %>%
sample_frac(.3)
p <- hclust(dist(df)) %>% ggtree(layout="fan", open.angle=10)
p + new_scale_fill() +
geom_fruit(data=dat2, geom=geom_tile,
mapping=aes(y=ID, x=name,alpha=value,fill=name),
color = "grey50",offset = 0.04,size = 0.02)+
scale_fill_manual(values=c("#FFC125","#87CEFA","#7B68EE","#808080",
"#800080", "#9ACD32","#D15FEE","#FFC0CB",
"#EE6A50","#8DEEEE", "#006400","#800000",
"#B0171F","#191970"))+
scale_alpha_continuous(guide=NULL)+
new_scale_fill()+
geom_fruit(data=dat3,geom=geom_bar,
mapping=aes(y=ID, x=value,fill=name),
pwidth=0.38,
orientation="y",
stat="identity",
)+
scale_fill_manual(values=c("#E64B35FF","#4DBBD5FF","#00A087FF","#3C5488FF","#F39B7FFF","#8491B4FF"))+
theme(legend.position=c(0.45, 0.5),
legend.background=element_rect(fill=NA),
legend.title=element_blank(),
legend.text=element_text(size=10)
)
p
